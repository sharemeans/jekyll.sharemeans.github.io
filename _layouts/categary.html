<!DOCTYPE html>
<html>
    <head>
        <title>{{ page.title }}</title>
        <link rel="stylesheet" type="text/css" href="/assets/css/default.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/flex.css">
        <link rel="stylesheet" type="text/css" href="/assets/iconfont/iconfont.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/common.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
        <link rel="stylesheet" href="/assets/css/categary.css">
        <script src="/assets/js/jquery.min.js"></script>
        <script src="/assets/js/categary.js"></script>
    </head>
    <body>
    <div class="categary">
        {% comment %} 标签块 {% endcomment %}
            <div class="categary__wrap js-tags">
                <a class="categary__wrap-item tag-button-all">全部</a>
                {% for tag in site.tags %}
                <a class="categary__wrap-item tag-button" data-encode="{{ tag[0] | strip | url_encode }}">{{ tag[0] }}</a>
                {% endfor %}
            </div>
            {% comment %} 以年份区分的列表 {% endcomment %}
            <div class="categary__list js-result d-none">
                {% assign _sorted_list = site.posts %}
                {% assign _sorted_list = _sorted_list | sort: 'date' %}
                {% assign _sorted_list = _sorted_list | reverse %}


                {% for _article in _sorted_list %}
                    {% assign _tags = '' %}
                    {% for _tag in _article.tags %}
                        {% assign _tag_encode = _tag | strip | url_encode %}
                        {% if forloop.last %}
                            {% assign _tags = _tags | append: _tag_encode %}
                        {% else %}
                            {% assign _tags = _tags | append: _tag_encode | append: ',' %}
                        {% endif %}
                    {% endfor %}

                {% comment %} group by year {% endcomment %}
                {% assign _currentdate = _article.date | date: '%Y' %}
                {% if _currentdate != _date %}
                    {% unless forloop.first %}</section>{% endunless %}
                    <section>
                    <span class="categary__list-seperator">
                        <span class="tag-text">{{ _currentdate }}</span>
                    </span>
                    {% assign _date = _currentdate %}
                {% endif %}

                    <div class="post-preview item" data-tags="{{ _tags }}">
                        <a href="{{ _article.url | prepend: site.baseurl }}">
                            <h2 class="post-title">
                                {{ _article.title }}
                            </h2>
                            {% if _article.subtitle %}
                            <h3 class="post-subtitle">
                                {{ _article.subtitle }}
                            </h3>
                            {% endif %}
                        </a>
                    </div>
                {% endfor %}
            </div>
        </div>
    </body>
</html>